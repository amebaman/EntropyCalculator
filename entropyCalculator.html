<!DOCTYPE html>
<html>
<head>
<script src="jquery-1.11.2.min.js"></script>
<!--<script src="entropyGame.js"></script> -->
<style>
body{
	background-color: #4D70BD
}
header{
	text-align: center 
}
button{
	display: table;
}

</style>
</head>
<body >
<header style= "font-family: symbol;">
<h1>Language Entropy Calculator</h1>
<h2>You have stumbled upon a fantastical Entropy calculator. </h2>
</header>
<center>
<button type="button"
onclick= "document.getElementById('StringDisplay').innerHTML = Date()">
Click me to start the game. </button>

<div id="StringDisplay"></div>

<script>
    var guess;
    var sentence;
    var done = false;
    var doneGuessing = true;
    var guessing = false;
    var index = 0;
    var answer;
    var numTries = 1;
    var guessArray = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    var displayString = "";
    var entropyCalculated = false;
    var capsConst = 'a'.charCodeAt() - 'A'.charCodeAt();
    // this basically grabs the sentence from the json and puts it into the "sentence" variable
    $.getJSON("data.json", function (data) {
        sentence = data.sentence;
	console.log(sentence);

	$(document).keypress(function(event) {
	    //console.log("guessing: " + guessing);
	    //console.log("doneGuessing: " + doneGuessing);
	    //console.log("keypress");
	    guessChar = event.key;
	    console.log(guessChar);
	    if (done) {
		//console.log("done");
		return;
	    }
	    if (doneGuessing) {
		//console.log("doneGuessing");
		//console.log(doneGuessing);
		getNextChar();
		doneGuessing = false;
	    }
	    if (!done && guessing) {
		//console.log("guessing");
		processGuess();
	    }
	});

	function processGuess() {
	    console.log("processing " + guessChar + " hoping for " + answer);
	    if ((guessChar < 'A' && guessChar != ' ') || guessChar > 'z' || (guessChar > 'Z' && guessChar < 'a')) {
		return; // do nothing and wait for real input that doesn't suck
	    }
	    if (guessChar == answer) {
		console.log("answer was " + guessChar);
		guessArray[numTries]++;
		if (nextChar != ' ') {
		    displayString += nextChar;
		}
		else {
		    displayString += '| |';
		}
		console.log(displayString);
		document.getElementById("StringDisplay").innerHTML = displayString;
		index++;
		numTries = 1;
		doneGuessing = true;
		guessing = false;
		$(document).keypress();
	    }
	    else {
		numTries++;
	    }
	    if (index >= sentence.length) {
		done = true;
		if (!entropyCalculated) {
		    calculateEntropy();
		    entropyCalculated = true;
		}
		return;
	    }
	}

	function getNextChar() {
	    nextChar = sentence.charAt(index);
	    answer = nextChar; 
	    while ((nextChar < 'A' && nextChar != ' ') || nextChar > 'z' || (nextChar > 'Z' && nextChar < 'a')) {
		console.log(nextChar + " rejected");
		displayString = displayString + nextChar;
		document.getElementById("StringDisplay").innerHTML = displayString;
		index++;
		if (index >= sentence.length) {
		    done =true;
		    if (!entropyCalculated) {
		        calculateEntropy();
		    entropyCalculated = true;
		}
		    return;
		}
		nextChar = sentence.charAt(index);
		answer = nextChar;
	    }
	    if (nextChar.charCodeAt() < 'a'.charCodeAt() && nextChar != ' ') {
		answer = String.fromCharCode(nextChar.charCodeAt() + capsConst);
	    }
	    guessing = true;   
	}

	function calculateEntropy() {
	    console.log("E N T R O P Y B O Y S");
	    return;
	}

	//console.log(data.sentence);
        //sentence = data.sentence;
	//document.getElementById("StringDisplay").innerHTML=sentence; // sets the StringDisplay div to sentence
    });
</script>

</center>
